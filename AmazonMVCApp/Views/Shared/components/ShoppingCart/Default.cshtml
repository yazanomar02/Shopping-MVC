@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}


@model ShoppingCartModel



@if(Model == null || Model.Cart == null || !Model.Cart.OrderItems.Any())
{
    <h5 class = "card-title">You have no items in your cart</h5>
}


else{

<h5 class="card-title">View your shopping cart</h5>
<code>
      @Url.Action(action: "Index",controller: "Cart",values: new { id = Model.Cart.CartId },protocol: Context.Request.Scheme)
</code>
    <form asp-controller="Cart" asp-action="Update">
    <table class="table">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Name</th>
                <th scope="col">Price</th>
                <th scope="col">Quantity</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.Cart.OrderItems.Select((x, i) => new { OrderItem = x, index = i }))
            {
                if (item.OrderItem.Product is null) continue;
                <tr>
                    <td>
                        <img class="card-img-top" src="~/imag/Products/@(item.OrderItem.Product.ProductId).jpg" alt="..." />
                    </td>
                    <td>@(item.OrderItem.Product?.Name)</td>
                    <td>@(item.OrderItem.Product?.Price.ToString("C"))</td>
                    <td>
                        <input type="hidden" name="products[@item.index].productId" value="@(item.OrderItem.Product.ProductId)" />
                        <select name="products[@item.index].productId" value="@item.OrderItem.Product.ProductId">
                                @for(int row = 0; row < 100; row++)
                                {
                                    @if(row == item.OrderItem.Quantity)
                                    {
                                        <option selected value="@row">@row</option>
                                    }

                                    else
                                    {
                                        <option value="@row">@row</option>
                                    }
                                }
                        </select>   
                    </td>
                </tr>
            }
        </tbody>
        <tfoot>
            <tr>
                <td>
                    <input type="hidden" name="cartId" value="@Model.Cart.CartId" />
                    <input type="submit" value="Update Cart" class="btn btn-primary" />
                </td>
            </tr>
        </tfoot>
    </table>
</form>

}

